Index: app/src/main/java/com/example/speechApplication/MainActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.speechapplication\r\n\r\nimport android.media.MediaPlayer\r\nimport android.os.Bundle\r\nimport android.widget.Button\r\nimport android.widget.ScrollView\r\nimport android.widget.TextView\r\nimport androidx.appcompat.app.AppCompatActivity\r\n\r\nclass MainActivity : AppCompatActivity(), WebSocketCallback {\r\n\r\n    companion object {\r\n        const val MAX_LOG_LINE_NUM = 200\r\n        var currLogLineNum = 0\r\n        var strLog: String? = null\r\n    }\r\n\r\n    private lateinit var speechRecognition: SpeechRecognition\r\n\r\n    private lateinit var btn: Button\r\n    private lateinit var btnRecord: Button\r\n    private lateinit var btnStop: Button\r\n    private lateinit var btnClear: Button\r\n    private lateinit var startPlayer: MediaPlayer\r\n    private lateinit var stopPlayer: MediaPlayer\r\n\r\n    private lateinit var log: TextView\r\n    private lateinit var logView: ScrollView\r\n\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n\r\n        super.onCreate(savedInstanceState)\r\n        setContentView(R.layout.activity_main)\r\n        setUI()\r\n        speechRecognition.startRecord()\r\n        speechRecognition.stopRecord()\r\n    }\r\n\r\n    private fun setUI() {\r\n        speechRecognition = SpeechRecognition(this, this)\r\n        // 设置 MediaPlayer\r\n        startPlayer = MediaPlayer.create(this, R.raw.ding)\r\n        stopPlayer = MediaPlayer.create(this, R.raw.dong)\r\n\r\n\r\n        // 设置 button 监听器\r\n        btn = findViewById(R.id.button)\r\n        btn.setOnClickListener { finish() }\r\n\r\n        log = findViewById(R.id.log)\r\n        logView = findViewById(R.id.logView)\r\n\r\n        speechRecognition.initialLog(log, logView)\r\n        speechRecognition.updateLog(\"----> 启动语音识别\", \"green\")\r\n\r\n        btnRecord = findViewById(R.id.start)\r\n        btnRecord.setOnClickListener {\r\n            // 触发开始录音事件\r\n            startPlayer.start()\r\n            Thread.sleep(1500) // 这个延时是等待提示音播完\r\n            speechRecognition.startRecord()\r\n        }\r\n\r\n        btnStop = findViewById(R.id.stop)\r\n        btnStop.setOnClickListener {\r\n            // 触发停止录音事件\r\n            speechRecognition.stopRecord()\r\n            stopPlayer.start()\r\n        }\r\n\r\n        btnClear = findViewById(R.id.btn_clear)\r\n        btnClear.setOnClickListener {\r\n            clearLog()\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 清除日志区的消息\r\n     */\r\n    private fun clearLog() {\r\n        log.post {\r\n            strLog = \"\"\r\n            currLogLineNum = 0\r\n            log.text = \"\"\r\n        }\r\n        logView.post {\r\n            logView.fullScroll(ScrollView.FOCUS_DOWN)\r\n        }\r\n    }\r\n\r\n    override fun onDataReceived(data: String) {\r\n        if (data.contains(\"返回\")) {\r\n            finish()\r\n        } else if(data.contains(\"清除\")) {\r\n            clearLog()\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/speechApplication/MainActivity.kt b/app/src/main/java/com/example/speechApplication/MainActivity.kt
--- a/app/src/main/java/com/example/speechApplication/MainActivity.kt	(revision 76dbe3feb3f97bb81a37522c92c3cb023cce636e)
+++ b/app/src/main/java/com/example/speechApplication/MainActivity.kt	(date 1691551151874)
@@ -32,6 +32,7 @@
         super.onCreate(savedInstanceState)
         setContentView(R.layout.activity_main)
         setUI()
+
         speechRecognition.startRecord()
         speechRecognition.stopRecord()
     }
